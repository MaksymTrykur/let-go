(ns test.async)

(test "go block concurrency"
      (let [x (atom 0)
            m 1
            a (go (println "a") 
                  (dotimes [u m] (println "inc") (swap! x inc))
                  (println "A"))
            b (go (println "b") 
                  (dotimes [v (* 2 m)] (println "dec") (swap! x dec))
                  (println "B"))]
        (<! b)
        (<! a) 
        (println @x)
        (= @x (- m))))